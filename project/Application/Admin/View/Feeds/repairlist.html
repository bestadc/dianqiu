<include file="Public/header" />
<div class="content">
    <include file="Public/nav" />
    <div class="row-fluid fl" id="main">
        <div class="tableBox">
            <div class="titleBar">建议及报修/<span>报修列表</span></div>
            <form class="form-search fr" action="__URL__/repairlist" method="get">
                <span class="select-box">
                  <select class="select" size="1" name="key" style="width: 100px;height: 32px;margin-top: 2px;">
                    <option value="1" selected>昵称</option>
                    <option value="2">手机</option>
                    <option value="3">地址</option>
                  </select>
                </span>
                <input type="text" class="input-medium" name="value" placeholder="请输入查询条件" / > 
                <button type="submit" class="btn">查找</button>
            </form>
            <table class="table table-striped table-bordered">
                <thead>
                <tr>
                    <th>报修编号</th>
                    <th>用户ID</th>
                    <th>设备编码</th>
                    <th>用户昵称</th>
                    <th>经销商手机</th>
                    <th>报修内容</th>
                    <th>图片</th>
                    <th>报修地址</th>
                    <th>报修时间</th>
                    <th>状态</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                    <notempty name="list">
                        <foreach name="list" item="vo" key="key">
                        <tr>
                            <td>{{$key+1}}</td>
                            <td>{{$vo.uid}}</td>
                            <td>{{$vo.device_code}}</td>
                            <td>{{$vo.name}}</td>
                            <td>{{$vo.phone}}</td>
                            <td>{{$vo.content}}</td>
                            <td><img width="40" src="__PUBLIC__{{$vo.picpath}}" alt=""></td>
                            <td>{{$vo.address}}</td>
                            <td>{{$vo.addtime|date='Y-m-d H:i:s',###}}</td>
                            <td>
                                <switch name="vo.status">
                                    <case value="0">待处理</case>
                                    <case value="1">已处理完成</case>
                                    <case value="2">正在处理中</case>
                                    <case value="3">任务进行中</case>
                                    <default />
                                </switch>
                            </td>
                            <td>
                                <switch name="vo.status">
                                    <case value="0"><a href="{{:U('Work/add',['id'=>$vo['id']])}}">生成工单</a></case>
                                    <default />
                                </switch>
                            </td>
                        </tr>
                        </foreach>
                    <else />
                        <tr>
                            <td colspan="10">查无数据</td>
                        </tr>
                    </notempty>
                </tbody>
            </table>
            <div class="pagination">
                <ul>
                    {{$button}}
                </ul>
            </div>
            <script>

                // 搜索
                if(window.location.search){
                    $('input[name=name]').val(decodeURI(window.location.search.slice(6)))
                }

                $('.pagination ul a').unwrap('div').wrap('<li></li>');
                $('.pagination ul span').wrap('<li class="active"></li>')
            </script>
        </div>
        <!-- footer part -->
        <include file="Public/footer" />
    </div>
    <script>
       
        // 搜索关键字保留
        if(window.location.search){
            // 获取搜索关键字
            var arr = window.location.search.split("&");
            $('select[name="key"] option[value='+decodeURI(arr[0].slice(arr[0].indexOf('=')+1))+']').attr("selected", true);
            $('input[name=value]').val(decodeURI(arr[1].slice(arr[1].indexOf('=')+1)))
            // console.log(arr)
        } 
    </script>
</div>


